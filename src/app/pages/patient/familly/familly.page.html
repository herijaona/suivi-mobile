<ion-header translucent="true">
  <ion-toolbar>
    <ion-buttons *ngIf="!ios && !showSearchbar" slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-menu-button *ngIf="ios"></ion-menu-button>
    <ion-title *ngIf="!ios && !showSearchbar">Famille</ion-title>
    <ion-searchbar
      *ngIf="showSearchbar"
      showCancelButton="always"
      [(ngModel)]="queryText"
      (ionChange)="updateRdvList()"
      (ionCancel)="showSearchbar= false"
      placeholder="Rechercher"
    ></ion-searchbar>
    <ion-buttons slot="end">
      <ion-button *ngIf="!ios && !showSearchbar" (click)="showSearchbar= true">
        <ion-icon slot="icon-only" name="search"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content *ngIf="!HAVE_A_MEMBER">
  <ion-button
    (click)="showAddGroup()"
    expand="block"
    fill="clear"
    color="primary"
    class="ion-text-center"
  >
    <ion-icon name="chevron-down-outline" *ngIf="!ADD_GROUP"></ion-icon>
    <ion-icon name="chevron-up-outline" *ngIf="ADD_GROUP"></ion-icon>
    <ion-label>
      &nbsp;&nbsp; Créer un groupe de famille &nbsp;&nbsp;
    </ion-label>
    <ion-icon name="chevron-down-outline" *ngIf="!ADD_GROUP"></ion-icon>
    <ion-icon name="chevron-up-outline" *ngIf="ADD_GROUP"></ion-icon>
  </ion-button>

  <ion-card *ngIf="ADD_GROUP">
    <form
      [formGroup]="addFamilyformGroup"
      (ngSubmit)="addNewFamilyGroup(this.addFamilyformGroup.value['groupname'])"
    >
      <div class="ion-padding">
        <ion-label>Group name<ion-text color="danger">*</ion-text> </ion-label>
        <ion-input
          required
          formControlName="groupname"
          type="text"
          class="border-input"
        >
        </ion-input>
      </div>

      <div class="ion-text-center">
        <ion-button
          color="success"
          type="submit"
          [disabled]="addFamilyformGroup.invalid"
        >
          validé
        </ion-button>
        <ion-button color="sred" (click)="showAddGroup()"> Annulé </ion-button>
      </div>
    </form>
  </ion-card>
</ion-content>

<ion-content *ngIf="HAVE_A_MEMBER">
  <ion-card>
    <ion-text color="primary">
      <h1 class="ion-text-left">
        Groupe : {{this.familyGroupe.groupe_info[0].Name}}
      </h1>
    </ion-text>
  </ion-card>
  <ion-button
    (click)="showAddMember()"
    expand="block"
    fill="clear"
    color="primary"
    class="ion-text-center"
  >
    <ion-icon name="chevron-down-outline" *ngIf="!ADD_MEMBER"></ion-icon>
    <ion-icon name="chevron-up-outline" *ngIf="ADD_MEMBER"></ion-icon>
    <ion-label>
      &nbsp;&nbsp; AJOUTER MEMBRE DANS LE GROUPE &nbsp;&nbsp;
    </ion-label>
    <ion-icon name="chevron-down-outline" *ngIf="!ADD_MEMBER"></ion-icon>
    <ion-icon name="chevron-up-outline" *ngIf="ADD_MEMBER"></ion-icon>
  </ion-button>

  <ion-card *ngIf="ADD_MEMBER">
    <form
      [formGroup]="addMemberFormGroup"
      (ngSubmit)="addNewFamilyMember(this.addMemberFormGroup.value['username'])"
    >
      <div class="ion-padding">
        <ion-label>Username<ion-text color="danger">*</ion-text></ion-label>
        <ion-input
          required
          formControlName="username"
          type="text"
          class="border-input"
        >
        </ion-input>
      </div>

      <div class="ion-text-center">
        <ion-button
          color="success"
          type="submit"
          [disabled]="addMemberFormGroup.invalid"
        >
          validé
        </ion-button>
        <ion-button color="sred" (click)="showAddMember()"> Annulé </ion-button>
      </div>
    </form>
  </ion-card>
  <ion-list #scheduleList>
    <ion-item-group>
      <ion-item-sliding #slidingItem>
        <ion-item
          lines="none"
          *ngFor="let member of
          this.familyGroupe.groupeMember"
        >
          <ion-card>
            <ion-card-content
              ><ion-grid>
                <ion-row>
                  <ion-col size="3">
                    <ion-label>
                      <img src="../../../assets/images/praticien.jpg" />
                    </ion-label>
                  </ion-col>
                  <ion-col size="7" class="information">
                    <h2 class="name">
                      {{member.firstName}} {{member.lastName}}
                    </h2>
                    <ion-label class="fonction"
                      >ID: {{member.username}}
                    </ion-label>

                    <ion-button
                      *ngIf="member.Referent"
                      class="status"
                      color="sorange"
                      expand="block"
                      fill="outline"
                    >
                      Réferent
                    </ion-button>
                    <ion-button
                      *ngIf="!member.Referent"
                      class="status"
                      color="sorange"
                      expand="block"
                      fill="outline"
                    >
                      Non Réferent
                    </ion-button>
                  </ion-col>
                  <ion-col size="2" class="trash">
                    <ion-button
                      color="sred"
                      fill="clear"
                      class="ion-text-center"
                      (click)="deleteMember(member)"
                    >
                      <ion-icon name="trash-bin-outline"></ion-icon>
                    </ion-button>
                  </ion-col>
                </ion-row>
                <ion-row> </ion-row>
              </ion-grid>
            </ion-card-content>
          </ion-card>
        </ion-item>
      </ion-item-sliding>
    </ion-item-group>
  </ion-list>
</ion-content>
